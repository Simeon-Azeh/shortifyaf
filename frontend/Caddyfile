:80
root * /srv

# static files
file_server

# reverse-proxy API calls to the backend service on port 3001
# Use `handle` to preserve the `/api` prefix so the Node backend routes under `/api` still match.
handle /api* {
	reverse_proxy backend:3001
}

# Handle short URL redirects (6-character alphanumeric strings)
handle /api/test-db {
	reverse_proxy backend:3001
}

handle /health {
	reverse_proxy backend:3001
}

# Handle short URLs (assuming 6-character alphanumeric)
handle /[a-zA-Z0-9]{6} {
	reverse_proxy backend:3001
}
